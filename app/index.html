<!doctype html>
<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="generator" content="Polymer Starter Kit">
  <title>Mission Command Center</title>

  <!-- Place favicon.ico in the `app/` directory -->

  <!-- Chrome for Android theme color -->
  <meta name="theme-color" content="#2E3AA1">

  <!-- Web Application Manifest -->
  <link rel="manifest" href="manifest.json">

  <!-- Tile color for Win8 -->
  <meta name="msapplication-TileColor" content="#3372DF">

  <!-- Add to homescreen for Chrome on Android -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="application-name" content="PSK">
  <link rel="icon" sizes="192x192" href="images/touch/chrome-touch-icon-192x192.png">

  <!-- Add to homescreen for Safari on iOS -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="Polymer Starter Kit">
  <link rel="apple-touch-icon" href="images/touch/apple-touch-icon.png">

  <!-- Tile icon for Win8 (144x144) -->
  <meta name="msapplication-TileImage" content="images/touch/ms-touch-icon-144x144-precomposed.png">

  <!-- build:css styles/main.css -->
  <link rel="stylesheet" href="styles/main.css">
  <!-- endbuild-->

  <!-- build:js bower_components/webcomponentsjs/webcomponents-lite.min.js -->
  <script src="bower_components/webcomponentsjs/webcomponents-lite.js"></script>
  <!-- endbuild -->
  <link rel="import" href="bower_components/google-map/google-map.html">
  <link rel="import" href="bower_components/google-map/google-map-directions.html">
  
  <link rel="import" href="bower_components/iron-icon/iron-icon.html">
  <link rel="import" href="bower_components/iron-icons/iron-icons.html">
  <link rel="import" href="bower_components/paper-item/paper-item.html">
  <link rel="import" href="bower_components/paper-item/paper-icon-item.html">
  <link rel="import" href="bower_components/paper-input/paper-input.html">
  <link rel="import" href="bower_components/paper-card/paper-card.html">
  <link rel="import" href="bower_components/paper-button/paper-button.html">

  <link rel="import" href="bower_components/iron-collapse/iron-collapse.html">
  <link rel="import" href="bower_components/iron-icons/maps-icons.html">
  <link rel="import" href="bower_components/paper-tabs/paper-tabs.html">
  <!-- Because this project uses vulcanize this should be your only html import
       in this file. All other imports should go in elements.html -->
  <link rel="import" href="elements/elements.html">

  <!-- For shared styles, shared-styles.html import in elements.html -->
  <style is="custom-style" include="shared-styles"></style>


</head>

<body unresolved>
<template is="dom-bind">

  <iron-collapse id="header">
      <img src="/images/logo.png"/>

      <paper-button class="custom pink">link</paper-button>
      <paper-button raised class="custom indigo">raised</paper-button>
      <paper-button toggles raised class="custom green">toggles</paper-button>
      <paper-button disabled class="custom disabled">disabled</paper-button>
  </iron-collapse>


  <google-map mouseEvents="true" additional-map-options='{"mapTypeId":"hybrid"}' map="{{map}}" latitude="17.4448706" longitude="78.3658851" zoom="13">
    <google-map-marker id = "sivaSOSDevice" latitude="17.4448706" longitude="78.3658851"
        title="Hey Siva!" draggable="true"></google-map-marker>
  </google-map>



<template repeat="&#123;{ letter in letters }}">
      &#123;{ letter }}
    </template>


  <google-map-directions map="{{map}}"
      start-address="{{start}}"
      end-address="{{end}}"></google-map-directions>

  <google-map-directions map="{{map}}"
      start-address="{{start1}}"
      end-address="{{end1}}"></google-map-directions>

  <paper-card elevation="2">
    <paper-icon-item>
      <paper-input label="Start address" value="{{start}}"/>
    </paper-icon-item>
    <paper-icon-item>
      <paper-input label="End address" value="{{end}}"/>
    </paper-icon-item>

  </paper-card>


<script>
console.log(HTMLImports);
HTMLImports.whenReady(function(){ 
  var gMap = document.querySelector('google-map');
  gMap.addEventListener('api-load', function(e) {
    document.querySelector('google-map-directions').map = this.map;
  });

  gMap.addEventListener("mousehover",function(e){
    document.querySelector("#header").toggle();
    document.querySelector("#footer").toggle();
  });
  gMap.addEventListener("mouseout",function(e){
    document.querySelector("#header").toggle();
    document.querySelector("#footer").toggle();
  });

  });

this.letters =  ['a', 'b', 'c'];
</script>


</template>
  <!-- <script src="scripts/app.js"></script> -->
  <!-- endbuild-->
</body>
<script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
<script>
console.log("Here is the logging for socket.io");
// Create SocketIO instance, connect
var socket = io.connect('http://100.72.0.15:80');

// Add a connect listener
socket.on('data',function(data) {
  console.log('Here is the data ',data, typeof data, data.toString());

  var decode = data.split(",");
  if (data.startsWith("!D")){
    var focusMarker = document.querySelector("#sivaSOSDevice");
    focusMarker.latitude = decode[3];
    focusMarker.longitude = decode[4];
    if(decode[7] == '1f0042'){
      alert("SOS alert at this location");
    }
  } 
});

socket.on('disconnect',function() {
  alert("Hey, disconnect");
  console.log('The client has disconnected!');
});

</script>
</html>
